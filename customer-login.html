<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AtoZ Customer Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    font-family: Arial;
    background: #f2f2f2;
    display: flex;
    justify-content: center;
    padding-top: 50px;
}

.card {
    background: white;
    padding: 30px;
    border-radius: 12px;
    width: 350px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}

h2 { text-align:center; }

input {
    width:100%;
    padding:12px;
    margin-top:10px;
    border:1px solid #ccc;
    border-radius:6px;
}

button {
    width:100%;
    padding:14px;
    margin-top:15px;
    border:none;
    border-radius:6px;
    font-weight:bold;
    cursor:pointer;
}

.login-btn { background:#4caf50; color:white; }
.reg-btn { background:#673ab7; color:white; }

/* Popup Style */
.modal {
  display: none;
  position: fixed;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.5);
}

.modal-content {
  background: white;
  padding: 25px;
  border-radius: 12px;
  width: 300px;
  text-align: center;
  margin: 15% auto;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.close {
  float: right;
  font-size: 20px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="card">
<h2>AtoZ Portal</h2>

<input type="text" id="mobile" placeholder="Mobile Number">

<hr>

<input type="text" id="name" placeholder="Full Name">
<input type="email" id="email" placeholder="Email">

<button class="login-btn" onclick="login()">Login</button>
<button class="reg-btn" onclick="register()">Register</button>
</div>

<!-- Popup Modal -->
<div id="popup" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <h3 id="popupTitle"></h3>
    <p id="popupMessage"></p>
  </div>
</div>

<script>

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwoj44SU498Qoqgv-9D4cTL8OZCIwRY6cbnJx49X8OGAO6Avgw9tmq1u9oL0KerS9RRtQ/exec";

function showPopup(title, message) {
  document.getElementById("popupTitle").innerText = title;
  document.getElementById("popupMessage").innerText = message;
  document.getElementById("popup").style.display = "block";
}

function closePopup() {
  document.getElementById("popup").style.display = "none";
}

async function register() {
    const name = document.getElementById("name").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const email = document.getElementById("email").value.trim();

    if (!name || !mobile || !email) {
        showPopup("Error", "Fill all fields.");
        return;
    }

    try {
        await fetch(SCRIPT_URL, {
            method: "POST",
            body: JSON.stringify({ name, mobile, email })
        });

        showPopup("Success", "Registration Sent Successfully!");

    } catch (err) {
        showPopup("Error", "Submission attempted.");
        console.log(err);
    }
}

async function login() {
    const mobile = document.getElementById("mobile").value.trim();

    if (!mobile) {
        showPopup("Error", "Enter mobile number.");
        return;
    }

    try {
        const response = await fetch(`${SCRIPT_URL}?mobile=${mobile}`);
        const result = await response.json();

        if (result.status === "found") {
            showPopup("Welcome", "Welcome " + result.name + "!");
        } else {
            showPopup("Error", "Mobile not found. Please register.");
        }

    } catch (err) {
        showPopup("Error", "Server error.");
        console.log(err);
    }
}

</script>

</body>
</html>
