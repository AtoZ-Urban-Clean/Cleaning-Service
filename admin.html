<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; display: flex; justify-content: center; }
    .card { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 400px; }
    h2 { color: #2c3e50; text-align: center; margin-bottom: 25px; }
    label { font-weight: bold; font-size: 0.9em; color: #555; }
    input, select { width: 100%; padding: 12px; margin: 8px 0 20px 0; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    button { width: 100%; padding: 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.3s; }
    .btn-search { background: #34495e; color: white; }
    .btn-save { background: #27ae60; color: white; display: none; }
    .info-box { background: #e8f4f8; padding: 10px; border-radius: 4px; margin-bottom: 20px; display: none; font-size: 0.85em; }
  </style>
</head>
<body>

<div class="card">
  <h2>Admin Panel</h2>
  
  <label>Search Booking ID</label>
  <input type="text" id="bookingId" placeholder="AZUC-20260209-5017">
  <button class="btn-search" onclick="search()">Find Booking</button>

  <div id="bookingInfo" class="info-box"></div>

  <div id="editForm" style="display:none;">
    <label>Status</label>
    <select id="status">
      <option value="Pending">Pending</option>
      <option value="Confirmed">Confirmed</option>
      <option value="Assigned">Assigned</option>
      <option value="Completed">Completed</option>
    </select>

    <label>Labour Name</label>
    <input type="text" id="labourName">

    <label>Labour Mobile</label>
    <input type="text" id="labourMobile">

    <button class="btn-save" id="saveBtn" onclick="save()">Update Records</button>
  </div>
  
  <p id="msg" style="text-align:center; font-weight:bold; color: #27ae60;"></p>
</div>

<script>
  function search() {
    const id = document.getElementById('bookingId').value;
    google.script.run.withSuccessHandler(showData).getBookingDetails(id);
  }

  function showData(data) {
    if(data) {
      document.getElementById('bookingInfo').style.display = 'block';
      document.getElementById('bookingInfo').innerHTML = `<strong>Customer:</strong> ${data.name}<br><strong>Service:</strong> ${data.service}`;
      document.getElementById('editForm').style.display = 'block';
      document.getElementById('saveBtn').style.display = 'block';
      
      document.getElementById('status').value = data.status || 'Pending';
      document.getElementById('labourName').value = data.labourName || '';
      document.getElementById('labourMobile').value = data.labourMobile || '';
    } else {
      alert("ID not found! Please check the ID in Column I.");
    }
  }

  function save() {
    const id = document.getElementById('bookingId').value;
    const st = document.getElementById('status').value;
    const ln = document.getElementById('labourName').value;
    const lm = document.getElementById('labourMobile').value;
    
    google.script.run.withSuccessHandler(res => {
      document.getElementById('msg').innerText = res;
    }).updateBooking(id, st, ln, lm);
  }
</script>

</body>
</html>
