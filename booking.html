<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Service | AtoZ Urban Clean</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="atoz.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --primary:#0066ff;
  --secondary:#ff007f;
  --bg:#f6f6f6;
}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:var(--bg);
}
header{
  background:#fff;
  padding:12px 16px;
  display:flex;
  align-items:center;
  border-bottom:1px solid #ddd;
  position:sticky;
  top:0;
}
header a{
  color:var(--primary);
  font-weight:800;
  text-decoration:none;
  font-size:14px;
}
header h2{
  flex:1;
  text-align:center;
  margin:0;
  font-size:15px;
  color:#555;
}
.container{
  max-width:600px;
  margin:15px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 6px 20px rgba(0,0,0,.08);
}
.service-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid #eee;
  padding:12px 0;
}
.qty{
  display:flex;
  gap:10px;
  align-items:center;
}
.qty button{
  width:26px;
  height:26px;
  border-radius:50%;
  border:1px solid #ccc;
  background:#fff;
  font-weight:bold;
}
.total{
  text-align:right;
  font-size:20px;
  font-weight:800;
  color:var(--primary);
  margin:15px 0;
}
label{
  display:block;
  margin-top:14px;
  font-weight:600;
  font-size:13px;
}
input{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ccc;
}
button.main{
  width:100%;
  padding:16px;
  background:var(--secondary);
  color:#fff;
  border:none;
  border-radius:8px;
  font-size:16px;
  font-weight:700;
  margin-top:20px;
}
.success{
  display:none;
  text-align:center;
}
.success h2{
  color:#25D366;
}
</style>
</head>

<body>

<header>
  <a href="index.html">AtoZ Urban Clean</a>
  <h2>Book Service</h2>
  <a href="services.html"><i class="fas fa-plus"></i></a>
</header>

<div class="container" id="formBox">

<h3>ðŸ§º Selected Services</h3>
<div id="serviceList"></div>
<div class="total">â‚¹ <span id="amount">0</span></div>

<label>Full Name</label>
<input id="name">

<label>Mobile Number</label>
<input id="mobile">

<label>Address</label>
<input id="location">

<label>Date & Time</label>
<div style="display:flex;gap:10px">
<input type="date" id="date">
<input type="time" id="time">
</div>

<button class="main" onclick="confirmBooking()">Confirm Booking</button>

</div>

<div class="container success" id="successBox">
<i class="fas fa-check-circle" style="font-size:60px"></i>
<h2>Booking Confirmed</h2>
<p>Your Booking ID:</p>
<h3 id="bookingIdText"></h3>
<a href="index.html">Back to Home</a>
</div>

<script>
const GOOGLE_FORM_ID = "1FAIpQLScoCFcqPBqNmzO3c4WHuiq--8rxAd-cBlH-BHkb68TNVE7G3w";

let cart = JSON.parse(localStorage.getItem("cart")) || [];
const list = document.getElementById("serviceList");
const amount = document.getElementById("amount");

function loadCart(){
  let total = 0;
  list.innerHTML = "";
  cart.forEach((i,idx)=>{
    i.qty=i.qty||1;
    total += i.price*i.qty;
    list.innerHTML += `
    <div class="service-item">
      <div>${i.name}<br>â‚¹${i.price}</div>
      <div class="qty">
        <button onclick="chg(${idx},-1)">-</button>
        <b>${i.qty}</b>
        <button onclick="chg(${idx},1)">+</button>
      </div>
    </div>`;
  });
  amount.innerText = total;
}

function chg(i,v){
  cart[i].qty += v;
  if(cart[i].qty<1)cart[i].qty=1;
  save();
}

function save(){
  localStorage.setItem("cart",JSON.stringify(cart));
  loadCart();
}

async function confirmBooking(){
  if(!name.value||!mobile.value||!location.value||!date.value||!time.value){
    alert("Fill all details");return;
  }
  if(cart.length===0){alert("Bag empty");return;}

  const bookingId = "AZC" + Date.now();
  const services = cart.map(i=>`${i.name} x${i.qty}`).join(", ");

  const fd = new FormData();
  fd.append("entry.1111111111", bookingId);
  fd.append("entry.470681689", name.value);
  fd.append("entry.574952680", mobile.value);
  fd.append("entry.2032518446", location.value);
  fd.append("entry.1025255991", date.value);
  fd.append("entry.1650273648", time.value);
  fd.append("entry.624600000", services);
  fd.append("entry.1504263480", amount.innerText);
  fd.append("entry.9999999999", "Pending");

  fetch(`https://docs.google.com/forms/d/e/${GOOGLE_FORM_ID}/formResponse`,{
    method:"POST",
    mode:"no-cors",
    body:fd
  });

  localStorage.removeItem("cart");
  formBox.style.display="none";
  successBox.style.display="block";
  bookingIdText.innerText = bookingId;
}

loadCart();
</script>
</body>
</html>
