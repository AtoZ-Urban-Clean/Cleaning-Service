<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Service | AtoZ Urban Clean</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="atoz.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root{
  --primary:#0066ff;
  --secondary:#ff007f;
  --whatsapp:#25D366;
  --bg:#f6f6f6;
  --text:#333;
}
body{margin:0;font-family:Segoe UI,Arial;background:var(--bg);color:var(--text)}
header{background:#fff;padding:12px 20px;display:flex;align-items:center;border-bottom:1px solid #ddd;position:sticky;top:0}
.company-name{flex:1}
.company-name a{text-decoration:none;font-weight:800;color:var(--primary)}
.page-title{flex:2;text-align:center;font-weight:600}
.container{max-width:600px;margin:20px auto;background:#fff;padding:25px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.08)}

.service-header{display:flex;justify-content:space-between;border-bottom:2px solid #eee;margin-bottom:15px}
.service-item{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid #eee}
.qty-controls{display:flex;gap:8px}
.qty-btn{width:26px;height:26px;border-radius:50%;border:1px solid #ccc;background:#fff}
.remove-btn{border:none;background:none;color:red;font-size:16px}
.total{text-align:right;font-size:22px;font-weight:800;color:var(--primary)}

label{margin-top:14px;display:block;font-weight:600;font-size:13px}
input{width:100%;padding:12px;margin-top:6px;border-radius:8px;border:1px solid #ddd}

.main-btn{margin-top:25px;width:100%;padding:16px;background:var(--secondary);color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:700}

.success{display:none;text-align:center}

  
</style>
</head>

<body>

<header>
  <div class="company-name"><a href="index.html">AtoZ Urban Clean</a></div>
  <div class="page-title">Book My Service</div>
</header>

<div class="container" id="formBox">

<div class="service-header">
  <h3>ðŸ§º Selected Services</h3>
  <button onclick="clearAll()">Clear</button>
</div>

<div id="serviceList"></div>
<div class="total">Total: â‚¹<span id="amount">0</span></div>

<label>Name</label>
<input id="name">

<label>Mobile</label>
<input id="mobile">

<label>Address</label>
<input id="location">

<label>Date & Time</label>
<input type="date" id="date">
<input type="time" id="time">

<button class="main-btn" onclick="confirmBooking()">Confirm Booking</button>
</div>

<div class="container success" id="successBox">
<h2>Booking Confirmed ðŸŽ‰</h2>
<p>Booking ID</p>
<h3 id="bookingIdText"></h3>

</a>

<a id="adminLink" style="display:block;margin-top:15px">Open Admin</a>
</div>

<script>
const GOOGLE_FORM_ID="1FAIpQLScoCFcqPBqNmzO3c4WHuiq--8rxAd-cBlH-BHkb68TNVE7G3w";
const ADMIN_PHONE="919489587626";

let cart=JSON.parse(localStorage.getItem("cart"))||[];
const list=document.getElementById("serviceList");
const amountDisplay=document.getElementById("amount");

function generateBookingId(){
  const d=new Date();
  const date=d.getFullYear()+String(d.getMonth()+1).padStart(2,"0")+String(d.getDate()).padStart(2,"0");
  return `AZUC-${date}-${Math.floor(1000+Math.random()*9000)}`;
}

function loadCart(){
  if(cart.length===0){
    list.innerHTML="<p>Your bag is empty</p>";
    amountDisplay.innerText=0;
    return;
  }
  let total=0;
  list.innerHTML="";
  cart.forEach((i,idx)=>{
    const qty=i.qty||1;
    const itemTotal=i.price*qty;
    total+=itemTotal;
    list.innerHTML+=`
      <div class="service-item">
        <div style="flex:1">
          <b>${i.name}</b><br>â‚¹${i.price}
        </div>
        <div class="qty-controls">
          <button class="qty-btn" onclick="updateQty(${idx},-1)">-</button>
          ${qty}
          <button class="qty-btn" onclick="updateQty(${idx},1)">+</button>
        </div>
        â‚¹${itemTotal}
        <button class="remove-btn" onclick="removeItem(${idx})">âœ•</button>
      </div>`;
  });
  amountDisplay.innerText=total;
}

function updateQty(i,c){cart[i].qty=(cart[i].qty||1)+c;if(cart[i].qty<1)cart[i].qty=1;save();}
function removeItem(i){cart.splice(i,1);save();}
function clearAll(){cart=[];save();}
function save(){localStorage.setItem("cart",JSON.stringify(cart));loadCart();}

function confirmBooking(){
  if(!cart.length)return alert("Cart empty");

  const bookingId=generateBookingId();
  const services=cart.map(i=>`${i.name} x${i.qty||1}`).join(", ");
  const total=amountDisplay.innerText;

  const fd=new FormData();
  fd.append("entry.470681689",name.value);
  fd.append("entry.574952680",mobile.value);
  fd.append("entry.2032518446",location.value);
  fd.append("entry.1025255991",date.value);
  fd.append("entry.1650273648",time.value);
  fd.append("entry.624600000",services);
  fd.append("entry.1504263480",total);
  fd.append("entry.1432715854","Pending");
  fd.append("entry.106701433",bookingId); // âœ… COLUMN I

  fetch(`https://docs.google.com/forms/d/e/${GOOGLE_FORM_ID}/formResponse`,
    {method:"POST",mode:"no-cors",body:fd});

  document.getElementById("bookingIdText").innerText=bookingId;
  document.getElementById("adminLink").href=`https://atozurbanclean.com/admin.html?bookingId=${bookingId}`;

  document.getElementById("waLink").href=
    `https://wa.me/${ADMIN_PHONE}?text=`+
    encodeURIComponent(`Booking ID: ${bookingId}\nServices: ${services}\nTotal: â‚¹${total}`);

  document.getElementById("formBox").style.display="none";
  document.getElementById("successBox").style.display="block";
  localStorage.removeItem("cart");
}

loadCart();
</script>
</body>
</html>
